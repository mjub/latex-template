% Set the document title.
% The starred version disable auto-capitalization.
\NewDocumentCommand \SetTitle {s >\TrimSpaces m}
  {%
    \title
      {%
        \IfBooleanTF{#1}
          {#2}
          {\iflanguage{french}{#2}{\titlecap{#2}}}%
      }
    \newcommand \Title {#2\xspace}

    \hypersetup{pdftitle={\Title}}
  }

% Set the author and, optionally, their email address.
\NewDocumentCommand \SetAuthor {>\TrimSpaces m >\TrimSpaces o}
  {%
    \IfValueT{#2}
      {%
        \newcommand \Email {\href{mailto:#2}{\texttt{#2}}\xspace}
      }
    \author{#1\IfValueT{#2}{~(\Email)}}
    \newcommand \Author {#1\xspace}

    \hypersetup{pdfauthor={\Author}}
  }
